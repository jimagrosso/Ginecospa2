<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GinecoSpa - Evaluaci√≥n de bienestar emocional. Descubre c√≥mo te sientes y recibe orientaci√≥n personalizada.">
    <title>GinecoSpa - Tu Bienestar Emocional</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* ============================================
           CSS VARIABLES - PALETA ROSADA PREMIUM
           ============================================ */
        :root {
            --rosa-palido: #FFF5F7;
            --rosa-claro: #FFE5EC;
            --rosa-medio: #FFB5C5;
            --rosa-intenso: #FF8FA3;
            --rosa-oscuro: #E75480;
            --rosa-profundo: #C9365E;
            --coral: #FF9B9B;
            --lavanda: #F3E8FF;
            --lavanda-medio: #E0CFFF;
            --gris-calido: #6B5D5D;
            --gris-suave: #9A8F8F;
            --crema: #FFF8F0;
            --blanco: #FFFFFF;
            --texto-principal: #3D2E2E;
            --texto-secundario: #7A6B6B;
            --sombra-rosa: rgba(231, 84, 128, 0.12);
            --sombra-suave: rgba(61, 46, 46, 0.06);
            --gradiente-hero: linear-gradient(135deg, #FFF5F7 0%, #FFE5EC 30%, #F3E8FF 70%, #FFF5F7 100%);
            --gradiente-boton: linear-gradient(135deg, #E75480 0%, #FF8FA3 100%);
            --gradiente-boton-hover: linear-gradient(135deg, #C9365E 0%, #E75480 100%);
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ============================================
           RESET & BASE
           ============================================ */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            color: var(--texto-principal);
            background: var(--gradiente-hero);
            background-attachment: fixed;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
            line-height: 1.2;
        }

        .font-script {
            font-family: 'Dancing Script', cursive;
        }

        /* ============================================
           BACKGROUND DECORATIONS
           ============================================ */
        .bg-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
        }

        .bg-orb-1 {
            width: 400px;
            height: 400px;
            background: var(--rosa-claro);
            top: -100px;
            right: -100px;
            animation: orbFloat 12s ease-in-out infinite;
        }

        .bg-orb-2 {
            width: 350px;
            height: 350px;
            background: var(--lavanda);
            bottom: -80px;
            left: -80px;
            animation: orbFloat 15s ease-in-out infinite reverse;
        }

        .bg-orb-3 {
            width: 250px;
            height: 250px;
            background: var(--rosa-medio);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: orbFloat 10s ease-in-out infinite 2s;
        }

        @keyframes orbFloat {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -20px) scale(1.05); }
            66% { transform: translate(-20px, 15px) scale(0.95); }
        }

        /* ============================================
           LAYOUT - MAIN CONTAINER
           ============================================ */
        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem 1rem;
        }

        /* ============================================
           HEADER / BRAND
           ============================================ */
        .brand-header {
            text-align: center;
            margin-bottom: 1.5rem;
            animation: fadeSlideDown 0.8s var(--transition-smooth);
        }

        .brand-header .logo-text {
            font-family: 'Dancing Script', cursive;
            font-size: 2rem;
            color: var(--rosa-oscuro);
            text-decoration: none;
            transition: opacity 0.3s;
        }

        .brand-header .logo-text:hover {
            opacity: 0.8;
        }

        .brand-header .subtitle {
            font-size: 0.75rem;
            color: var(--gris-suave);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        /* ============================================
           WIZARD CARD
           ============================================ */
        .wizard-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 229, 236, 0.6);
            border-radius: 28px;
            box-shadow: 
                0 4px 24px var(--sombra-rosa),
                0 1px 3px var(--sombra-suave);
            width: 100%;
            max-width: 600px;
            padding: 2rem 1.5rem;
            position: relative;
            overflow: hidden;
            transition: box-shadow 0.3s var(--transition-smooth);
        }

        .wizard-card:hover {
            box-shadow: 
                0 8px 40px var(--sombra-rosa),
                0 2px 6px var(--sombra-suave);
        }

        /* Decorative top line */
        .wizard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradiente-boton);
            border-radius: 28px 28px 0 0;
        }

        @media (min-width: 640px) {
            .wizard-card {
                padding: 2.5rem 3rem;
            }
        }

        /* ============================================
           PROGRESS BAR
           ============================================ */
        .progress-wrapper {
            margin-bottom: 2rem;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .progress-step {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--rosa-oscuro);
            letter-spacing: 0.5px;
        }

        .progress-percentage {
            font-size: 0.75rem;
            color: var(--gris-suave);
            font-weight: 500;
        }

        .progress-bar-track {
            width: 100%;
            height: 6px;
            background: var(--rosa-claro);
            border-radius: 100px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--gradiente-boton);
            border-radius: 100px;
            transition: width 0.5s var(--transition-smooth);
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ============================================
           QUESTION SCREEN
           ============================================ */
        .question-screen {
            position: relative;
            min-height: 320px;
        }

        .question-slide {
            animation: slideIn 0.45s var(--transition-smooth);
        }

        .question-slide.slide-out-left {
            animation: slideOutLeft 0.35s var(--transition-smooth) forwards;
        }

        .question-slide.slide-out-right {
            animation: slideOutRight 0.35s var(--transition-smooth) forwards;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(40px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInReverse {
            from {
                opacity: 0;
                transform: translateX(-40px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutLeft {
            to {
                opacity: 0;
                transform: translateX(-40px);
            }
        }

        @keyframes slideOutRight {
            to {
                opacity: 0;
                transform: translateX(40px);
            }
        }

        @keyframes fadeSlideDown {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Category emoji/icon */
        .question-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
            animation: floatIcon 3s ease-in-out infinite;
        }

        @keyframes floatIcon {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }

        /* Empathetic title */
        .question-category {
            font-family: 'Dancing Script', cursive;
            font-size: 1.1rem;
            color: var(--rosa-oscuro);
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .question-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--texto-principal);
            margin-bottom: 1.5rem;
            line-height: 1.35;
        }

        @media (min-width: 640px) {
            .question-text {
                font-size: 1.6rem;
            }
        }

        /* ============================================
           RADIO OPTIONS
           ============================================ */
        .options-group {
            display: flex;
            flex-direction: column;
            gap: 0.65rem;
            margin-bottom: 1.25rem;
        }

        .option-item {
            position: relative;
        }

        .option-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .option-label {
            display: flex;
            align-items: center;
            gap: 0.85rem;
            padding: 0.9rem 1.1rem;
            background: var(--blanco);
            border: 2px solid var(--rosa-claro);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.25s var(--transition-smooth);
            font-size: 0.9rem;
            color: var(--texto-principal);
            user-select: none;
        }

        .option-label:hover {
            border-color: var(--rosa-medio);
            background: var(--rosa-palido);
            transform: translateY(-1px);
            box-shadow: 0 2px 12px var(--sombra-rosa);
        }

        /* Custom radio circle */
        .option-radio-circle {
            width: 22px;
            height: 22px;
            min-width: 22px;
            border-radius: 50%;
            border: 2px solid var(--rosa-medio);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s var(--transition-smooth);
        }

        .option-radio-circle::after {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--rosa-oscuro);
            transform: scale(0);
            transition: transform 0.25s var(--transition-smooth);
        }

        /* Selected state */
        .option-item input[type="radio"]:checked + .option-label {
            border-color: var(--rosa-oscuro);
            background: linear-gradient(135deg, var(--rosa-palido), rgba(255, 229, 236, 0.5));
            box-shadow: 0 2px 16px var(--sombra-rosa);
        }

        .option-item input[type="radio"]:checked + .option-label .option-radio-circle {
            border-color: var(--rosa-oscuro);
            background: var(--rosa-palido);
        }

        .option-item input[type="radio"]:checked + .option-label .option-radio-circle::after {
            transform: scale(1);
        }

        /* Checkmark animation on select */
        .option-item input[type="radio"]:checked + .option-label .option-check {
            opacity: 1;
            transform: scale(1);
        }

        .option-check {
            margin-left: auto;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.25s var(--transition-smooth);
            color: var(--rosa-oscuro);
            font-size: 1rem;
        }

        /* Focus for keyboard */
        .option-item input[type="radio"]:focus-visible + .option-label {
            outline: 3px solid var(--rosa-intenso);
            outline-offset: 2px;
        }

        /* ============================================
           OBSERVATIONS TEXTAREA
           ============================================ */
        .observations-wrapper {
            margin-bottom: 1.5rem;
        }

        .observations-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--gris-suave);
            transition: color 0.2s;
            padding: 0.3rem 0;
            background: none;
            border: none;
            font-family: 'Montserrat', sans-serif;
        }

        .observations-toggle:hover {
            color: var(--rosa-oscuro);
        }

        .observations-toggle svg {
            transition: transform 0.3s var(--transition-smooth);
        }

        .observations-toggle.active svg {
            transform: rotate(180deg);
        }

        .observations-area {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s var(--transition-smooth), opacity 0.3s;
            opacity: 0;
        }

        .observations-area.open {
            max-height: 150px;
            opacity: 1;
            margin-top: 0.5rem;
        }

        .observations-area textarea {
            width: 100%;
            min-height: 70px;
            padding: 0.8rem 1rem;
            border: 2px solid var(--rosa-claro);
            border-radius: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            color: var(--texto-principal);
            background: var(--blanco);
            resize: vertical;
            transition: border-color 0.2s, box-shadow 0.2s;
            outline: none;
        }

        .observations-area textarea:focus {
            border-color: var(--rosa-intenso);
            box-shadow: 0 0 0 3px rgba(231, 84, 128, 0.1);
        }

        .observations-area textarea::placeholder {
            color: var(--gris-suave);
            font-style: italic;
        }

        /* ============================================
           VALIDATION MESSAGE
           ============================================ */
        .validation-msg {
            display: none;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: var(--rosa-oscuro);
            margin-bottom: 1rem;
            padding: 0.5rem 0.8rem;
            background: rgba(231, 84, 128, 0.08);
            border-radius: 8px;
            animation: fadeSlideUp 0.3s var(--transition-smooth);
        }

        .validation-msg.show {
            display: flex;
        }

        /* ============================================
           NAVIGATION BUTTONS
           ============================================ */
        .nav-buttons {
            display: flex;
            gap: 0.75rem;
            justify-content: space-between;
            margin-top: 0.5rem;
        }

        .btn {
            padding: 0.85rem 1.8rem;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            border: none;
            outline: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn:focus-visible {
            outline: 3px solid var(--rosa-intenso);
            outline-offset: 3px;
        }

        .btn-prev {
            background: var(--blanco);
            color: var(--gris-calido);
            border: 2px solid var(--rosa-claro);
        }

        .btn-prev:hover {
            border-color: var(--rosa-medio);
            background: var(--rosa-palido);
            color: var(--rosa-oscuro);
        }

        .btn-next {
            background: var(--gradiente-boton);
            color: var(--blanco);
            box-shadow: 0 4px 16px rgba(231, 84, 128, 0.3);
            flex: 1;
            justify-content: center;
        }

        .btn-next:hover {
            background: var(--gradiente-boton-hover);
            box-shadow: 0 6px 24px rgba(231, 84, 128, 0.4);
            transform: translateY(-1px);
        }

        .btn-next:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(231, 84, 128, 0.3);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-arrow {
            transition: transform 0.2s;
        }

        .btn-next:hover .btn-arrow {
            transform: translateX(3px);
        }

        .btn-prev:hover .btn-arrow-back {
            transform: translateX(-3px);
        }

        /* ============================================
           WELCOME SCREEN
           ============================================ */
        .welcome-screen {
            text-align: center;
            padding: 1rem 0;
            animation: scaleIn 0.6s var(--transition-smooth);
        }

        .welcome-icon {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            display: block;
            animation: floatIcon 4s ease-in-out infinite;
        }

        .welcome-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--texto-principal);
            margin-bottom: 0.75rem;
        }

        .welcome-subtitle {
            font-family: 'Dancing Script', cursive;
            font-size: 1.1rem;
            color: var(--rosa-oscuro);
            margin-bottom: 1.25rem;
        }

        .welcome-text {
            font-size: 0.9rem;
            color: var(--texto-secundario);
            margin-bottom: 2rem;
            max-width: 420px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }

        .welcome-features {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .welcome-feature {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.75rem;
            color: var(--gris-suave);
        }

        .welcome-feature span:first-child {
            font-size: 1.3rem;
        }

        .btn-start {
            background: var(--gradiente-boton);
            color: var(--blanco);
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 24px rgba(231, 84, 128, 0.3);
            transition: all 0.3s var(--transition-smooth);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-start:hover {
            background: var(--gradiente-boton-hover);
            box-shadow: 0 8px 32px rgba(231, 84, 128, 0.4);
            transform: translateY(-2px);
        }

        /* ============================================
           ANALYZING SCREEN
           ============================================ */
        .analyzing-screen {
            text-align: center;
            padding: 3rem 1rem;
            animation: fadeIn 0.5s var(--transition-smooth);
        }

        .analyzing-spinner {
            width: 64px;
            height: 64px;
            border: 4px solid var(--rosa-claro);
            border-top-color: var(--rosa-oscuro);
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .analyzing-dots {
            display: inline-flex;
            gap: 4px;
            margin-left: 4px;
        }

        .analyzing-dots span {
            width: 5px;
            height: 5px;
            background: var(--rosa-oscuro);
            border-radius: 50%;
            animation: dotPulse 1.4s ease-in-out infinite;
        }

        .analyzing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .analyzing-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes dotPulse {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
            40% { transform: scale(1); opacity: 1; }
        }

        .analyzing-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            color: var(--texto-principal);
            margin-bottom: 0.5rem;
        }

        .analyzing-subtext {
            font-size: 0.85rem;
            color: var(--gris-suave);
        }

        /* ============================================
           SAFETY ALERT (QUESTION 10 CRITICAL)
           ============================================ */
        .safety-alert {
            background: linear-gradient(135deg, #FFF0F0, #FFF5F7);
            border: 2px solid var(--rosa-oscuro);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            animation: scaleIn 0.4s var(--transition-smooth);
        }

        .safety-alert-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .safety-alert h3 {
            font-size: 1.1rem;
            color: var(--rosa-oscuro);
            margin-bottom: 0.5rem;
        }

        .safety-alert p {
            font-size: 0.85rem;
            color: var(--texto-secundario);
            line-height: 1.6;
        }

        .safety-alert a {
            color: var(--rosa-oscuro);
            font-weight: 600;
            text-decoration: underline;
        }

        /* ============================================
           RESULTS SCREEN
           ============================================ */
        .results-screen {
            animation: fadeSlideUp 0.6s var(--transition-smooth);
        }

        .results-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .results-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 0.75rem;
        }

        .results-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.6rem;
            color: var(--texto-principal);
            margin-bottom: 0.25rem;
        }

        .results-subtitle {
            font-family: 'Dancing Script', cursive;
            font-size: 1rem;
            color: var(--rosa-oscuro);
        }

        /* Level Badge */
        .level-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 1rem auto;
        }

        .level-leve {
            background: linear-gradient(135deg, #E8F8F0, #D4EFDF);
            color: #2E7D5B;
            border: 1px solid #B8E6CC;
        }

        .level-moderado {
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            color: #C77A00;
            border: 1px solid #FFD54F;
        }

        .level-elevado {
            background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
            color: #C62828;
            border: 1px solid #EF9A9A;
        }

        .results-message {
            font-size: 0.9rem;
            color: var(--texto-secundario);
            line-height: 1.7;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* Recommendations */
        .recommendations {
            background: var(--rosa-palido);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
        }

        .recommendations h4 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            color: var(--texto-principal);
            margin-bottom: 0.75rem;
        }

        .recommendation-item {
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            padding: 0.5rem 0;
            font-size: 0.85rem;
            color: var(--texto-secundario);
            line-height: 1.5;
        }

        .recommendation-item span:first-child {
            font-size: 1rem;
            flex-shrink: 0;
            margin-top: 1px;
        }

        /* Divider */
        .divider {
            height: 1px;
            background: linear-gradient(to right, transparent, var(--rosa-claro), transparent);
            margin: 1.5rem 0;
        }

        /* ============================================
           CTA CONTACT SECTION
           ============================================ */
        .cta-section {
            text-align: center;
        }

        .cta-section h4 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            color: var(--texto-principal);
            margin-bottom: 0.5rem;
        }

        .cta-section p {
            font-size: 0.8rem;
            color: var(--gris-suave);
            margin-bottom: 1.25rem;
        }

        .cta-buttons {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1.25rem;
        }

        .btn-cta {
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            border: 2px solid var(--rosa-medio);
            background: var(--blanco);
            color: var(--rosa-oscuro);
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
        }

        .btn-cta:hover,
        .btn-cta.active {
            background: var(--gradiente-boton);
            color: var(--blanco);
            border-color: var(--rosa-oscuro);
            box-shadow: 0 4px 16px rgba(231, 84, 128, 0.25);
        }

        /* Contact form */
        .contact-form {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s var(--transition-smooth), opacity 0.3s;
            opacity: 0;
        }

        .contact-form.open {
            max-height: 300px;
            opacity: 1;
        }

        .contact-input-group {
            margin-bottom: 0.75rem;
        }

        .contact-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid var(--rosa-claro);
            border-radius: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            color: var(--texto-principal);
            background: var(--blanco);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .contact-input:focus {
            border-color: var(--rosa-intenso);
            box-shadow: 0 0 0 3px rgba(231, 84, 128, 0.1);
        }

        .contact-input::placeholder {
            color: var(--gris-suave);
        }

        .consent-label {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--gris-suave);
            margin-bottom: 1rem;
            cursor: pointer;
            text-align: left;
        }

        .consent-label input[type="checkbox"] {
            accent-color: var(--rosa-oscuro);
            margin-top: 2px;
            width: 16px;
            height: 16px;
        }

        .btn-submit {
            background: var(--gradiente-boton);
            color: var(--blanco);
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(231, 84, 128, 0.3);
            transition: all 0.3s var(--transition-smooth);
            width: 100%;
        }

        .btn-submit:hover {
            background: var(--gradiente-boton-hover);
            transform: translateY(-1px);
        }

        /* Success message */
        .success-msg {
            display: none;
            text-align: center;
            padding: 1.5rem;
            animation: scaleIn 0.4s var(--transition-smooth);
        }

        .success-msg.show {
            display: block;
        }

        .success-msg .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .success-msg h4 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            color: var(--texto-principal);
            margin-bottom: 0.3rem;
        }

        .success-msg p {
            font-size: 0.85rem;
            color: var(--gris-suave);
        }

        /* ============================================
           RESTART BUTTON
           ============================================ */
        .btn-restart {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            margin-top: 1.5rem;
            font-size: 0.8rem;
            color: var(--gris-suave);
            background: none;
            border: none;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            transition: color 0.2s;
        }

        .btn-restart:hover {
            color: var(--rosa-oscuro);
        }

        /* ============================================
           FOOTER
           ============================================ */
        .app-footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            font-size: 0.7rem;
            color: var(--gris-suave);
        }

        .app-footer a {
            color: var(--rosa-oscuro);
            text-decoration: none;
        }

        .app-footer .disclaimer {
            max-width: 500px;
            margin: 0.5rem auto 0;
            line-height: 1.5;
            font-size: 0.65rem;
            opacity: 0.7;
        }

        /* ============================================
           UTILITY: HIDDEN
           ============================================ */
        .hidden {
            display: none !important;
        }

        /* ============================================
           SCROLL BAR
           ============================================ */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--rosa-medio);
            border-radius: 100px;
        }

        /* ============================================
           SENSITIVE TOPIC NOTICE (Q10)
           ============================================ */
        .sensitive-notice {
            background: linear-gradient(135deg, var(--lavanda), var(--rosa-palido));
            border-radius: 12px;
            padding: 0.8rem 1rem;
            margin-bottom: 1rem;
            font-size: 0.78rem;
            color: var(--texto-secundario);
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            line-height: 1.5;
        }

        .sensitive-notice span:first-child {
            font-size: 1rem;
            flex-shrink: 0;
        }
    </style>
</head>
<body>

    <!-- Background orbs -->
    <div class="bg-orb bg-orb-1"></div>
    <div class="bg-orb bg-orb-2"></div>
    <div class="bg-orb bg-orb-3"></div>

    <!-- ============================================
         MAIN APP
         ============================================ -->
    <div class="app-container">

        <!-- Brand -->
        <header class="brand-header">
            <a href="index.html" class="logo-text">GinecoSpa</a>
            <div class="subtitle">Bienestar Emocional</div>
        </header>

        <!-- Wizard Card -->
        <main class="wizard-card" id="wizardCard" role="main" aria-label="Cuestionario de bienestar emocional">

            <!-- ====== WELCOME SCREEN ====== -->
            <section id="welcomeScreen" class="welcome-screen" aria-label="Bienvenida">
                <span class="welcome-icon" aria-hidden="true">üå∏</span>
                <h1 class="welcome-title">Tu bienestar importa</h1>
                <p class="welcome-subtitle">Un espacio seguro para ti</p>
                <p class="welcome-text">
                    Este breve cuestionario te ayudar√° a reflexionar sobre c√≥mo te has sentido √∫ltimamente. 
                    No es un diagn√≥stico, sino una herramienta de orientaci√≥n inicial.
                </p>
                <div class="welcome-features">
                    <div class="welcome-feature">
                        <span aria-hidden="true">üîí</span>
                        <span>Privado</span>
                    </div>
                    <div class="welcome-feature">
                        <span aria-hidden="true">‚è±Ô∏è</span>
                        <span>3‚Äì5 min</span>
                    </div>
                    <div class="welcome-feature">
                        <span aria-hidden="true">üíú</span>
                        <span>10 preguntas</span>
                    </div>
                </div>
                <button class="btn-start" id="btnStart" aria-label="Comenzar cuestionario">
                    Comenzar
                    <span class="btn-arrow" aria-hidden="true">‚Üí</span>
                </button>
            </section>

            <!-- ====== PERSONAL INFO SCREEN ====== -->
            <section id="personalScreen" class="hidden" aria-label="Datos personales">
                <div class="question-slide" style="animation-name: slideIn;">
                    <span class="question-icon" aria-hidden="true">üëã</span>
                    <p class="question-category">Antes de comenzar</p>
                    <h2 class="question-text">Cu√©ntanos un poco sobre ti</h2>
                    <p style="font-size: 0.8rem; color: var(--gris-suave); margin-bottom: 1.5rem;">
                        Esta informaci√≥n nos ayuda a personalizar tu orientaci√≥n. Es confidencial.
                    </p>

                    <div style="display: flex; flex-direction: column; gap: 0.85rem; margin-bottom: 1.5rem;">
                        <!-- Nombre -->
                        <div>
                            <label for="personalName" style="display: block; font-size: 0.8rem; font-weight: 600; color: var(--texto-secundario); margin-bottom: 0.35rem;">
                                Nombre <span style="color: var(--rosa-oscuro);">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="personalName" 
                                class="contact-input" 
                                placeholder="¬øC√≥mo te llamas?"
                                autocomplete="given-name"
                                required
                            >
                        </div>

                        <!-- Edad -->
                        <div>
                            <label for="personalAge" style="display: block; font-size: 0.8rem; font-weight: 600; color: var(--texto-secundario); margin-bottom: 0.35rem;">
                                Edad <span style="color: var(--rosa-oscuro);">*</span>
                            </label>
                            <input 
                                type="number" 
                                id="personalAge" 
                                class="contact-input" 
                                placeholder="Ej: 28"
                                min="12"
                                max="120"
                                autocomplete="off"
                                required
                            >
                        </div>

                        <!-- Ciudad -->
                        <div>
                            <label for="personalCity" style="display: block; font-size: 0.8rem; font-weight: 600; color: var(--texto-secundario); margin-bottom: 0.35rem;">
                                Ciudad <span style="color: var(--rosa-oscuro);">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="personalCity" 
                                class="contact-input" 
                                placeholder="Ej: Caracas, Barquisimeto‚Ä¶"
                                autocomplete="address-level2"
                                required
                            >
                        </div>
                    </div>

                    <!-- Validation -->
                    <div class="validation-msg" id="personalValidation" role="alert">
                        <span aria-hidden="true">üí°</span>
                        <span>Por favor, completa todos los campos para continuar</span>
                    </div>

                    <!-- Button -->
                    <div style="display: flex; justify-content: center;">
                        <button class="btn btn-next" id="btnStartQuiz" style="max-width: 300px;">
                            Comenzar cuestionario
                            <span class="btn-arrow" aria-hidden="true">‚Üí</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ====== QUIZ SCREEN ====== -->
            <section id="quizScreen" class="hidden" aria-label="Preguntas del cuestionario">

                <!-- Progress -->
                <div class="progress-wrapper">
                    <div class="progress-info">
                        <span class="progress-step" id="progressStep">Pregunta 1 de 10</span>
                        <span class="progress-percentage" id="progressPercent">10%</span>
                    </div>
                    <div class="progress-bar-track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="10">
                        <div class="progress-bar-fill" id="progressFill" style="width: 10%"></div>
                    </div>
                </div>

                <!-- Question Container -->
                <div class="question-screen" id="questionContainer">
                    <!-- Dynamically rendered -->
                </div>

                <!-- Validation -->
                <div class="validation-msg" id="validationMsg" role="alert">
                    <span aria-hidden="true">üí°</span>
                    <span>Por favor, selecciona una opci√≥n para continuar</span>
                </div>

                <!-- Navigation -->
                <div class="nav-buttons">
                    <button class="btn btn-prev" id="btnPrev" aria-label="Pregunta anterior">
                        <span class="btn-arrow-back" aria-hidden="true">‚Üê</span>
                        Anterior
                    </button>
                    <button class="btn btn-next" id="btnNext" aria-label="Siguiente pregunta">
                        Siguiente
                        <span class="btn-arrow" aria-hidden="true">‚Üí</span>
                    </button>
                </div>
            </section>

            <!-- ====== ANALYZING SCREEN ====== -->
            <section id="analyzingScreen" class="hidden" aria-label="Analizando respuestas">
                <div class="analyzing-screen">
                    <div class="analyzing-spinner" aria-hidden="true"></div>
                    <p class="analyzing-text">
                        Analizando tus respuestas
                        <span class="analyzing-dots" aria-hidden="true">
                            <span></span><span></span><span></span>
                        </span>
                    </p>
                    <p class="analyzing-subtext">Preparando tu orientaci√≥n personalizada</p>
                </div>
            </section>

            <!-- ====== SAFETY ALERT SCREEN ====== -->
            <section id="safetyScreen" class="hidden" aria-label="Alerta de seguridad">
                <div class="safety-alert">
                    <span class="safety-alert-icon" aria-hidden="true">ü§ç</span>
                    <h3>Tu seguridad es lo primero</h3>
                    <p>
                        Si sientes que est√°s en peligro inmediato, por favor busca ayuda de emergencia en tu pa√≠s. 
                        No est√°s solo/a y hay personas que pueden ayudarte ahora mismo.
                    </p>
                    <p style="margin-top: 0.75rem;">
                        <strong>Venezuela:</strong> L√≠nea 0-800 / Emergencias 911<br>
                        <strong>Internacional:</strong> Busca la l√≠nea de crisis de tu pa√≠s
                    </p>
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-next" id="btnContinueToResults" style="max-width: 280px;">
                        Continuar a mi orientaci√≥n
                        <span class="btn-arrow" aria-hidden="true">‚Üí</span>
                    </button>
                </div>
            </section>

            <!-- ====== RESULTS SCREEN ====== -->
            <section id="resultsScreen" class="hidden" aria-label="Resultados">
                <div class="results-screen">

                    <div class="results-header">
                        <span class="results-icon" aria-hidden="true" id="resultsIcon">üåø</span>
                        <h2 class="results-title">Tu orientaci√≥n inicial</h2>
                        <p class="results-subtitle">Un primer paso hacia tu bienestar</p>
                    </div>

                    <!-- Level Badge -->
                    <div style="text-align: center;">
                        <span class="level-badge" id="levelBadge"></span>
                    </div>

                    <!-- Message -->
                    <p class="results-message" id="resultsMessage"></p>

                    <!-- Recommendations -->
                    <div class="recommendations" id="recommendationsList"></div>

                    <div class="divider"></div>

                    <!-- ====== PREMIUM CTA - NIVEL 2 ====== -->
                    <div class="premium-cta-section" id="premiumCtaSection">
                        <div style="text-align: center; margin-bottom: 1.2rem;">
                            <span style="display: inline-flex; align-items: center; gap: 6px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 6px 16px; border-radius: 50px; font-size: 0.72rem; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase;">üß† An√°lisis con IA</span>
                        </div>
                        <h4 style="text-align: center; font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; color: #3D2E2E; margin-bottom: 0.5rem;">¬øQuieres un an√°lisis m√°s profundo?</h4>
                        <p style="text-align: center; color: #7A6B6B; font-size: 0.88rem; margin-bottom: 1.2rem;">Desbloquea un cuestionario de 25 preguntas + un informe personalizado generado por Inteligencia Artificial</p>

                        <div style="background: linear-gradient(135deg, #FFF5F7, #F3E8FF); border-radius: 16px; padding: 1.2rem; margin-bottom: 1.2rem;">
                            <div style="display: flex; flex-direction: column; gap: 8px; font-size: 0.85rem; color: #3D2E2E;">
                                <div style="display: flex; align-items: center; gap: 8px;">‚úÖ 25 preguntas profundas sobre bienestar emocional</div>
                                <div style="display: flex; align-items: center; gap: 8px;">‚úÖ An√°lisis personalizado con Inteligencia Artificial</div>
                                <div style="display: flex; align-items: center; gap: 8px;">‚úÖ √Åreas de fortaleza y atenci√≥n identificadas</div>
                                <div style="display: flex; align-items: center; gap: 8px;">‚úÖ Plan de acci√≥n semanal personalizado</div>
                                <div style="display: flex; align-items: center; gap: 8px;">‚úÖ Acceso a profesionales especializados</div>
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <button id="btnPremium" style="
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                border: none;
                                padding: 16px 36px;
                                border-radius: 50px;
                                font-family: 'Montserrat', sans-serif;
                                font-size: 1rem;
                                font-weight: 700;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                                display: inline-flex;
                                align-items: center;
                                gap: 8px;
                            " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(102, 126, 234, 0.4)'"
                               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'"
                            >
                                üîì Desbloquear por $3 USD
                            </button>
                            <p style="font-size: 0.75rem; color: #9A8F8F; margin-top: 0.7rem;">Pago seguro con Stripe ¬∑ Resultado inmediato</p>
                        </div>

                        <div id="premiumLoading" style="display: none; text-align: center; padding: 1rem;">
                            <div style="width: 36px; height: 36px; border: 3px solid #E0CFFF; border-top-color: #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 0.8rem;"></div>
                            <p style="color: #7A6B6B; font-size: 0.88rem;">Redirigiendo a pago seguro...</p>
                        </div>
                    </div>

                    <div class="divider"></div>

                    <!-- CTA CONTACTO GRATUITO -->
                    <div class="cta-section" id="ctaSection">
                        <h4>O si prefieres, recibe orientaci√≥n gratuita</h4>
                        <p>Elige c√≥mo prefieres recibirlo</p>

                        <div class="cta-buttons">
                            <button class="btn-cta" id="btnEmail" data-method="email">
                                <span aria-hidden="true">‚úâÔ∏è</span> Recibir por correo
                            </button>
                            <button class="btn-cta" id="btnWhatsapp" data-method="whatsapp">
                                <span aria-hidden="true">üí¨</span> Recibir por WhatsApp
                            </button>
                        </div>

                        <!-- Contact Form -->
                        <div class="contact-form" id="contactForm">
                            <div class="contact-input-group">
                                <input 
                                    type="email" 
                                    class="contact-input" 
                                    id="contactInput" 
                                    placeholder="tu@correo.com"
                                    aria-label="Correo electr√≥nico"
                                >
                            </div>
                            <label class="consent-label">
                                <input type="checkbox" id="consentCheck">
                                <span>Acepto recibir informaci√≥n y recomendaciones sobre bienestar emocional</span>
                            </label>
                            <button class="btn-submit" id="btnSubmit">Enviar</button>
                        </div>

                        <!-- Success Message -->
                        <div class="success-msg" id="successMsg">
                            <span class="icon" aria-hidden="true">üíå</span>
                            <h4>¬°Listo!</h4>
                            <p>Te contactaremos pronto con informaci√≥n personalizada.</p>
                        </div>
                    </div>

                    <!-- Restart -->
                    <div style="text-align: center;">
                        <button class="btn-restart" id="btnRestart">
                            <span aria-hidden="true">‚Ü∫</span> Realizar de nuevo
                        </button>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>
                <a href="index.html" class="font-script" style="font-size: 0.9rem;">GinecoSpa</a>
                &nbsp;¬∑&nbsp; Bienestar √çntimo y Est√©tico
            </p>
            <p class="disclaimer">
                Este cuestionario no constituye un diagn√≥stico m√©dico ni sustituye la evaluaci√≥n profesional. 
                Es una herramienta de orientaci√≥n general. Si necesitas ayuda, consulta con un especialista.
            </p>
        </footer>

    </div>

    <!-- ============================================
         JAVASCRIPT - APP LOGIC
         ============================================ -->
    <script>
    (() => {
        'use strict';

        // ============================================
        // QUESTIONNAIRE DATA
        // ============================================
        const questions = [
            {
                id: 1,
                icon: 'üíú',
                category: 'Estado emocional',
                text: 'En los √∫ltimos 14 d√≠as, ¬øc√≥mo te has sentido emocionalmente?',
                options: [
                    'Bien y estable',
                    'Algo deca√≠do/a',
                    'Bastante desanimado/a',
                    'Muy mal la mayor parte del tiempo'
                ]
            },
            {
                id: 2,
                icon: '‚ú®',
                category: 'Motivaci√≥n',
                text: '¬øHas perdido inter√©s o ganas de hacer cosas que antes disfrutabas?',
                options: ['Nunca', 'A veces', 'Frecuentemente', 'Casi siempre']
            },
            {
                id: 3,
                icon: 'üåä',
                category: 'Ansiedad',
                text: '¬øCon qu√© frecuencia te sientes preocupado/a, nervioso/a o en tensi√≥n?',
                options: ['Nunca', 'A veces', 'Frecuentemente', 'Casi siempre']
            },
            {
                id: 4,
                icon: 'üß†',
                category: 'Pensamientos',
                text: '¬øSientes que tu mente no se detiene y repites pensamientos negativos?',
                options: ['Nunca', 'A veces', 'Frecuentemente', 'Casi siempre']
            },
            {
                id: 5,
                icon: 'üåô',
                category: 'Descanso',
                text: '¬øC√≥mo ha sido tu descanso √∫ltimamente?',
                options: [
                    'Duermo bien y me siento descansado/a',
                    'Duermo, pero no descanso bien',
                    'Me despierto varias veces',
                    'Duermo muy mal o casi no duermo'
                ]
            },
            {
                id: 6,
                icon: '‚ö°',
                category: 'Energ√≠a',
                text: '¬øC√≥mo describir√≠as tu nivel de energ√≠a diaria?',
                options: [
                    'Buena',
                    'Algo baja',
                    'Muy baja',
                    'Me siento agotado/a constantemente'
                ]
            },
            {
                id: 7,
                icon: 'üìã',
                category: 'Funcionalidad',
                text: '¬øQu√© tanto te cuesta cumplir con tus responsabilidades diarias?',
                options: ['Nada', 'Un poco', 'Mucho', 'Casi no puedo']
            },
            {
                id: 8,
                icon: 'üî•',
                category: 'Irritabilidad',
                text: '¬øTe sientes irritable, sensible o reaccionas m√°s de lo normal?',
                options: ['Nunca', 'A veces', 'Frecuentemente', 'Casi siempre']
            },
            {
                id: 9,
                icon: 'ü§ù',
                category: 'Apoyo social',
                text: '¬øSientes que tienes apoyo emocional cuando lo necesitas?',
                options: [
                    'S√≠, suficiente',
                    'Algo',
                    'Poco',
                    'Nada'
                ]
            },
            {
                id: 10,
                icon: 'ü§ç',
                category: 'Seguridad personal',
                text: 'En los √∫ltimos d√≠as, ¬øhas tenido pensamientos de hacerte da√±o o de no querer seguir?',
                options: [
                    'No',
                    'S√≠, pensamientos ocasionales',
                    'S√≠, pensamientos frecuentes',
                    'S√≠, y me preocupa mi seguridad'
                ],
                sensitive: true
            }
        ];

        // ============================================
        // STATE
        // ============================================
        let currentStep = 0; // 0 = welcome
        let answers = new Array(questions.length).fill(null);
        let notes = new Array(questions.length).fill('');
        let contactMethod = null;
        let direction = 'forward'; // 'forward' | 'backward'
        let personalData = { name: '', age: '', city: '' };

        // ============================================
        // DOM REFERENCES
        // ============================================
        const $ = (sel) => document.querySelector(sel);
        const welcomeScreen = $('#welcomeScreen');
        const personalScreen = $('#personalScreen');
        const quizScreen = $('#quizScreen');
        const analyzingScreen = $('#analyzingScreen');
        const safetyScreen = $('#safetyScreen');
        const resultsScreen = $('#resultsScreen');

        const btnStart = $('#btnStart');
        const btnStartQuiz = $('#btnStartQuiz');
        const btnPrev = $('#btnPrev');
        const btnNext = $('#btnNext');
        const btnContinueToResults = $('#btnContinueToResults');
        const btnRestart = $('#btnRestart');
        const btnEmail = $('#btnEmail');
        const btnWhatsapp = $('#btnWhatsapp');
        const btnSubmit = $('#btnSubmit');

        const progressStep = $('#progressStep');
        const progressPercent = $('#progressPercent');
        const progressFill = $('#progressFill');
        const questionContainer = $('#questionContainer');
        const validationMsg = $('#validationMsg');
        const contactForm = $('#contactForm');
        const contactInput = $('#contactInput');
        const consentCheck = $('#consentCheck');
        const successMsg = $('#successMsg');
        const ctaSection = $('#ctaSection');

        // ============================================
        // SCREEN MANAGEMENT
        // ============================================
        function showScreen(screen) {
            [welcomeScreen, personalScreen, quizScreen, analyzingScreen, safetyScreen, resultsScreen]
                .forEach(s => s.classList.add('hidden'));
            screen.classList.remove('hidden');
        }

        // ============================================
        // RENDER QUESTION
        // ============================================
        function renderQuestion(index) {
            const q = questions[index];
            const selectedAnswer = answers[index];
            const currentNote = notes[index];

            const sensitiveNotice = q.sensitive ? `
                <div class="sensitive-notice">
                    <span aria-hidden="true">üíú</span>
                    <span>Esta pregunta es delicada. Responde con honestidad; tu bienestar es lo m√°s importante. Toda informaci√≥n es confidencial.</span>
                </div>
            ` : '';

            const animClass = direction === 'forward' ? 'question-slide' : 'question-slide';

            const html = `
                <div class="${animClass}" style="animation-name: ${direction === 'forward' ? 'slideIn' : 'slideInReverse'}">
                    <span class="question-icon" aria-hidden="true">${q.icon}</span>
                    <p class="question-category">${q.category}</p>
                    <h2 class="question-text">${q.text}</h2>
                    ${sensitiveNotice}
                    <div class="options-group" role="radiogroup" aria-label="${q.text}">
                        ${q.options.map((opt, i) => `
                            <div class="option-item">
                                <input 
                                    type="radio" 
                                    name="q${q.id}" 
                                    id="q${q.id}_opt${i}" 
                                    value="${i}"
                                    ${selectedAnswer === i ? 'checked' : ''}
                                    tabindex="0"
                                >
                                <label class="option-label" for="q${q.id}_opt${i}">
                                    <span class="option-radio-circle"></span>
                                    <span>${opt}</span>
                                    <span class="option-check" aria-hidden="true">‚úì</span>
                                </label>
                            </div>
                        `).join('')}
                    </div>

                    <div class="observations-wrapper">
                        <button 
                            class="observations-toggle ${currentNote ? 'active' : ''}" 
                            type="button"
                            aria-expanded="${currentNote ? 'true' : 'false'}"
                            aria-controls="obsArea${q.id}"
                            id="obsToggle"
                        >
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                            Agregar observaci√≥n (opcional)
                        </button>
                        <div class="observations-area ${currentNote ? 'open' : ''}" id="obsArea${q.id}">
                            <textarea 
                                placeholder="Escribe aqu√≠ cualquier detalle que quieras agregar‚Ä¶"
                                aria-label="Observaciones opcionales"
                                id="obsTextarea"
                            >${currentNote}</textarea>
                        </div>
                    </div>
                </div>
            `;

            questionContainer.innerHTML = html;

            // Bind radio events
            const radios = questionContainer.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    answers[index] = parseInt(e.target.value);
                    validationMsg.classList.remove('show');
                });
            });

            // Bind observation toggle
            const toggle = $('#obsToggle');
            const area = $(`#obsArea${q.id}`);
            const textarea = $('#obsTextarea');

            toggle.addEventListener('click', () => {
                const isOpen = area.classList.toggle('open');
                toggle.classList.toggle('active', isOpen);
                toggle.setAttribute('aria-expanded', isOpen);
                if (isOpen && textarea) textarea.focus();
            });

            // Save notes on input
            if (textarea) {
                textarea.addEventListener('input', (e) => {
                    notes[index] = e.target.value;
                });
            }

            // Update progress
            updateProgress(index);

            // Update nav buttons
            btnPrev.style.display = index === 0 ? 'none' : 'inline-flex';
            btnNext.textContent = index === questions.length - 1 ? 'Ver resultados' : 'Siguiente';
            btnNext.innerHTML = index === questions.length - 1 
                ? 'Ver resultados <span class="btn-arrow" aria-hidden="true">‚Üí</span>'
                : 'Siguiente <span class="btn-arrow" aria-hidden="true">‚Üí</span>';

            // Hide validation
            validationMsg.classList.remove('show');
        }

        // ============================================
        // PROGRESS
        // ============================================
        function updateProgress(index) {
            const total = questions.length;
            const pct = Math.round(((index + 1) / total) * 100);
            progressStep.textContent = `Pregunta ${index + 1} de ${total}`;
            progressPercent.textContent = `${pct}%`;
            progressFill.style.width = `${pct}%`;
            progressFill.parentElement.setAttribute('aria-valuenow', pct);
        }

        // ============================================
        // SCORING & RESULTS (DEMO MODE)
        // ============================================
        function calculateResults() {
            const totalScore = answers.reduce((sum, a) => sum + (a !== null ? a : 0), 0);
            const maxScore = questions.length * 3; // max is 30
            const riskFlag = answers[9] === 3; // Last option on Q10

            let level, levelClass, icon, message, recommendations;

            if (riskFlag || totalScore >= 21) {
                level = 'Elevado';
                levelClass = 'level-elevado';
                icon = 'ü§ç';
                message = 'Tus respuestas sugieren que podr√≠as estar atravesando un momento dif√≠cil que merece atenci√≥n profesional. Recuerda que buscar ayuda es un acto de valent√≠a, no de debilidad. Mereces sentirte mejor.';
                recommendations = [
                    { icon: 'ü©∫', text: 'Considera hablar con un profesional de salud mental lo antes posible.' },
                    { icon: 'ü§ù', text: 'Busca apoyo en personas de confianza: familia, amigos o l√≠neas de ayuda.' },
                    { icon: 'üíú', text: 'Practica peque√±os actos de autocuidado: descanso, alimentaci√≥n y momentos de calma.' }
                ];
            } else if (totalScore >= 11) {
                level = 'Moderado';
                levelClass = 'level-moderado';
                icon = 'üå§Ô∏è';
                message = 'Tus respuestas indican que hay algunas √°reas de tu bienestar emocional que podr√≠an beneficiarse de atenci√≥n. Es completamente normal sentirse as√≠ en momentos de la vida, y dar este paso ya dice mucho de ti.';
                recommendations = [
                    { icon: 'üßò', text: 'Incorpora rutinas de relajaci√≥n: respiraci√≥n consciente, meditaci√≥n o yoga suave.' },
                    { icon: 'üóìÔ∏è', text: 'Establece horarios regulares de sue√±o y alimentaci√≥n para crear estabilidad.' },
                    { icon: 'üí¨', text: 'Hablar con alguien de confianza o un profesional puede ayudarte a procesar lo que sientes.' }
                ];
            } else {
                level = 'Leve';
                levelClass = 'level-leve';
                icon = 'üåø';
                message = 'Tus respuestas sugieren que, en general, te encuentras en un estado emocional relativamente estable. Aun as√≠, es maravilloso que te tomes el tiempo de revisar c√≥mo te sientes ‚Äî la prevenci√≥n es clave.';
                recommendations = [
                    { icon: 'üå±', text: 'Mant√©n tus h√°bitos saludables: ejercicio, buena alimentaci√≥n y conexi√≥n social.' },
                    { icon: 'üìù', text: 'Lleva un diario emocional para identificar patrones y celebrar tu bienestar.' },
                    { icon: 'üå∏', text: 'Dedica tiempo semanal a actividades que te brinden alegr√≠a y descanso.' }
                ];
            }

            return { totalScore, maxScore, level, levelClass, icon, message, recommendations, riskFlag };
        }

        function showResults(results) {
            // Icon
            $('#resultsIcon').textContent = results.icon;

            // Personalize title with name
            const displayName = personalData.name ? personalData.name.split(' ')[0] : '';
            if (displayName) {
                $('.results-subtitle').textContent = `${displayName}, este es un primer paso hacia tu bienestar`;
            }

            // Level badge
            const badge = $('#levelBadge');
            badge.className = `level-badge ${results.levelClass}`;
            badge.innerHTML = `<span aria-hidden="true">${results.icon}</span> Nivel: ${results.level}`;

            // Message
            $('#resultsMessage').textContent = results.message;

            // Recommendations
            const recList = $('#recommendationsList');
            recList.innerHTML = `
                <h4>üí° Recomendaciones generales</h4>
                ${results.recommendations.map(r => `
                    <div class="recommendation-item">
                        <span aria-hidden="true">${r.icon}</span>
                        <span>${r.text}</span>
                    </div>
                `).join('')}
            `;

            showScreen(resultsScreen);
        }

        // ============================================
        // BACKEND INTEGRATION (PLACEHOLDER)
        // ============================================
        /**
         * submitToBackend(payload)
         * 
         * Env√≠a los datos del cuestionario a Google Sheets
         * via Google Apps Script Web App.
         * 
         * INSTRUCCIONES:
         * Reemplaza BACKEND_URL con la URL de tu Apps Script desplegado.
         */
        
        // ‚¨áÔ∏è PEGA AQU√ç TU URL DE GOOGLE APPS SCRIPT ‚¨áÔ∏è
        const BACKEND_URL = 'https://script.google.com/macros/s/AKfycbyeh72tKkhH8C1jTXN0dDKuClXolPnPxCvhYP4j7FeBXpM7EE1kvGQ9qUb5WMxgtq8k/exec';
        // ‚¨ÜÔ∏è Ejemplo: 'https://script.google.com/macros/s/AKfycb.../exec'

        async function submitToBackend(payload) {
            console.log('=== PAYLOAD PARA BACKEND ===');
            console.log(JSON.stringify(payload, null, 2));

            // Si no hay URL configurada, solo hacer log
            if (!BACKEND_URL || BACKEND_URL === 'PEGA_TU_URL_AQUI') {
                console.warn('‚ö†Ô∏è BACKEND_URL no configurada. Datos solo en consola.');
                return { success: false, message: 'URL no configurada' };
            }

            try {
                const response = await fetch(BACKEND_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify(payload),
                    mode: 'no-cors'
                });
                
                // Con no-cors no podemos leer la respuesta,
                // pero los datos s√≠ llegan a Google Sheets
                console.log('‚úÖ Datos enviados a Google Sheets');
                return { success: true, message: 'Enviado' };
                
            } catch (error) {
                console.error('‚ùå Error enviando datos:', error);
                // No bloquear la experiencia del usuario si falla
                return { success: false, message: error.message };
            }
        }

        // ============================================
        // BUILD PAYLOAD
        // ============================================
        function buildPayload(contact = null) {
            return {
                action: 'submit-nivel1',
                personalData: {
                    name: personalData.name,
                    age: personalData.age,
                    city: personalData.city
                },
                answers: answers.map((a, i) => ({
                    questionId: i + 1,
                    questionText: questions[i].text,
                    selectedOption: a,
                    selectedText: a !== null ? questions[i].options[a] : null
                })),
                optionalNotes: notes.map((n, i) => ({
                    questionId: i + 1,
                    note: n || null
                })).filter(n => n.note),
                timestamp: new Date().toISOString(),
                riskFlag: answers[9] === 3,
                contact: contact
            };
        }

        // ============================================
        // EVENT HANDLERS
        // ============================================

        // Start -> go to personal info
        btnStart.addEventListener('click', () => {
            showScreen(personalScreen);
        });

        // Personal info -> start quiz
        btnStartQuiz.addEventListener('click', () => {
            const name = $('#personalName').value.trim();
            const age = $('#personalAge').value.trim();
            const city = $('#personalCity').value.trim();
            const validation = $('#personalValidation');

            if (!name || !age || !city) {
                validation.classList.add('show');
                // Focus first empty field
                if (!name) $('#personalName').focus();
                else if (!age) $('#personalAge').focus();
                else $('#personalCity').focus();
                return;
            }

            validation.classList.remove('show');
            personalData = { name, age: parseInt(age), city };

            currentStep = 1;
            showScreen(quizScreen);
            renderQuestion(0);
        });

        // Hide personal validation on input
        ['personalName', 'personalAge', 'personalCity'].forEach(id => {
            $(`#${id}`).addEventListener('input', () => {
                $('#personalValidation').classList.remove('show');
            });
        });

        // Next
        btnNext.addEventListener('click', () => {
            const qIndex = currentStep - 1;

            // Validate selection
            if (answers[qIndex] === null) {
                validationMsg.classList.add('show');
                return;
            }

            direction = 'forward';

            if (currentStep < questions.length) {
                // Next question
                currentStep++;
                renderQuestion(currentStep - 1);
            } else {
                // Finished! Submit payload
                const payload = buildPayload();
                submitToBackend(payload);

                // Check risk flag -> show safety screen first
                if (payload.riskFlag) {
                    showScreen(safetyScreen);
                } else {
                    // Show analyzing then results
                    showScreen(analyzingScreen);
                    setTimeout(() => {
                        const results = calculateResults();
                        showResults(results);
                    }, 2500);
                }
            }
        });

        // Previous
        btnPrev.addEventListener('click', () => {
            if (currentStep > 1) {
                direction = 'backward';
                currentStep--;
                renderQuestion(currentStep - 1);
            }
        });

        // Continue from safety screen to results
        btnContinueToResults.addEventListener('click', () => {
            showScreen(analyzingScreen);
            setTimeout(() => {
                const results = calculateResults();
                showResults(results);
            }, 2500);
        });

        // CTA buttons
        btnEmail.addEventListener('click', () => {
            contactMethod = 'email';
            btnEmail.classList.add('active');
            btnWhatsapp.classList.remove('active');
            contactInput.type = 'email';
            contactInput.placeholder = 'tu@correo.com';
            contactInput.setAttribute('aria-label', 'Correo electr√≥nico');
            contactInput.value = '';
            contactForm.classList.add('open');
            setTimeout(() => contactInput.focus(), 300);
        });

        btnWhatsapp.addEventListener('click', () => {
            contactMethod = 'whatsapp';
            btnWhatsapp.classList.add('active');
            btnEmail.classList.remove('active');
            contactInput.type = 'tel';
            contactInput.placeholder = '+58 412 1234567';
            contactInput.setAttribute('aria-label', 'N√∫mero de WhatsApp');
            contactInput.value = '';
            contactForm.classList.add('open');
            setTimeout(() => contactInput.focus(), 300);
        });

        // Submit contact
        btnSubmit.addEventListener('click', () => {
            const value = contactInput.value.trim();
            if (!value) {
                contactInput.style.borderColor = 'var(--rosa-oscuro)';
                contactInput.focus();
                return;
            }

            const contact = {
                method: contactMethod,
                value: value,
                consent: consentCheck.checked
            };

            // Build and send full payload with contact
            const payload = buildPayload(contact);
            submitToBackend(payload);

            // Show success
            contactForm.classList.remove('open');
            ctaSection.querySelector('h4').style.display = 'none';
            ctaSection.querySelector('p').style.display = 'none';
            document.querySelector('.cta-buttons').style.display = 'none';
            successMsg.classList.add('show');
        });

        // Reset input border on focus
        contactInput.addEventListener('focus', () => {
            contactInput.style.borderColor = 'var(--rosa-intenso)';
        });

        // ============================================
        // PREMIUM CHECKOUT (NIVEL 2)
        // ============================================
        const btnPremium = $('#btnPremium');
        const premiumLoading = $('#premiumLoading');

        if (btnPremium) {
            btnPremium.addEventListener('click', async () => {
                // Show loading
                btnPremium.style.display = 'none';
                premiumLoading.style.display = 'block';

                // Calculate results for metadata
                const results = calculateResults();

                try {
                    const response = await fetch(BACKEND_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify({
                            action: 'create-checkout',
                            customerName: personalData.name || '',
                            customerEmail: '',
                            nivel1Data: {
                                totalScore: results.totalScore,
                                level: results.level
                            }
                        })
                    });

                    const result = await response.json();

                    if (result.success && result.checkoutUrl) {
                        // Redirect to Stripe Checkout
                        window.location.href = result.checkoutUrl;
                    } else {
                        alert('Error al crear la sesi√≥n de pago. Por favor intenta de nuevo.');
                        btnPremium.style.display = 'inline-flex';
                        premiumLoading.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error de conexi√≥n. Por favor intenta de nuevo.');
                    btnPremium.style.display = 'inline-flex';
                    premiumLoading.style.display = 'none';
                }
            });
        }

        // Restart
        btnRestart.addEventListener('click', () => {
            currentStep = 0;
            answers = new Array(questions.length).fill(null);
            notes = new Array(questions.length).fill('');
            contactMethod = null;
            personalData = { name: '', age: '', city: '' };

            // Reset personal fields
            $('#personalName').value = '';
            $('#personalAge').value = '';
            $('#personalCity').value = '';

            // Reset UI states
            successMsg.classList.remove('show');
            contactForm.classList.remove('open');
            ctaSection.querySelector('h4').style.display = '';
            ctaSection.querySelector('p').style.display = '';
            document.querySelector('.cta-buttons').style.display = '';
            btnEmail.classList.remove('active');
            btnWhatsapp.classList.remove('active');

            showScreen(welcomeScreen);
        });

        // ============================================
        // KEYBOARD NAVIGATION
        // ============================================
        document.addEventListener('keydown', (e) => {
            if (quizScreen.classList.contains('hidden')) return;

            if (e.key === 'Enter' && !e.target.matches('textarea')) {
                e.preventDefault();
                btnNext.click();
            }
        });

        // ============================================
        // OPTIONAL: SAVE TO LOCALSTORAGE
        // ============================================
        function saveState() {
            try {
                localStorage.setItem('ginecospa_quiz_state', JSON.stringify({
                    currentStep,
                    answers,
                    notes,
                    personalData
                }));
            } catch (e) { /* silently fail */ }
        }

        function loadState() {
            try {
                const saved = localStorage.getItem('ginecospa_quiz_state');
                if (saved) {
                    const state = JSON.parse(saved);
                    if (state.answers && state.answers.length === questions.length) {
                        currentStep = state.currentStep || 0;
                        answers = state.answers;
                        notes = state.notes || new Array(questions.length).fill('');
                        personalData = state.personalData || { name: '', age: '', city: '' };

                        // Restore personal fields
                        if (personalData.name) $('#personalName').value = personalData.name;
                        if (personalData.age) $('#personalAge').value = personalData.age;
                        if (personalData.city) $('#personalCity').value = personalData.city;

                        if (currentStep > 0 && currentStep <= questions.length) {
                            showScreen(quizScreen);
                            renderQuestion(currentStep - 1);
                        }
                    }
                }
            } catch (e) { /* silently fail */ }
        }

        // Auto-save on changes (debounced)
        let saveTimeout;
        const autoSave = () => {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(saveState, 500);
        };

        // Hook auto-save to answer changes
        const originalRender = renderQuestion;
        // Override to add autosave hooks
        const _origRender = renderQuestion;

        // Save state after any interaction
        document.addEventListener('change', autoSave);
        document.addEventListener('input', autoSave);

        // Load saved state on init
        loadState();

    })();
    </script>

</body>
</html>
